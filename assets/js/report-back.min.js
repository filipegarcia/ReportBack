function saveReport(){var t="<h3>All done</h3>  Now it's up to you to do something with the gathered info.<br/>Check console to view the log of the report object ";$("#reportDialog").html(t),console.log(report)}function report_warmup_dyn(t){$.getScript("assets/js/bootstrap.min.js"),$("head").append($('<link rel="stylesheet" type="text/css" />').attr("href","assets/css/bootstrap.min.css")),$("head").append($('<link rel="stylesheet" type="text/css" />').attr("href","assets/css/jquery.ui.css")),$.getScript("assets/js/jquery.base64.min.js"),$.getScript("assets/js/html2canvas.js"),drawDialog(),goStep1(),report.user=t}function report_warmup(){$("#feedback").on("click",function(){drawDialog(),goStep1()})}function drawDialog(){var t='<div id="reportDialog" title="Give us your feedback :)"></div>';step1=' <div id="step1">        <form>          <div class="row-fluid">          Report Back lets you send suggestions about the product.					 We welcome problem reports, feature ideas and general comments.<br/><br/>					 Legal notifications sent through Report Back will not be processed and they\'r something I don\'t care about in here.<br/><br/>					 Start by writing a brief description:          <textarea id="usrDescription" rows="5" class="span12"></textarea>						Next we\'ll let you identify areas of the page related to your description.          </div>        </form>      </div>',step2='<div id="step2" style="display:none;">	<p>Click and drag on the page to help us better understand your feedback.			 You can move this dialog if it\'s in the way.</p>			<div>				<div class="row-fluid">					<div class="span12"> <button id="highlight" class="btn btn-primary" type="button"><i class="icon-eye-open"></i> Highlight&nbsp;</button>					 Highlight areas relevant to your feedback.</div>				</div><br/>				<div class="row-fluid">					<div class="span12"> <button id="block" class="btn" type="button"><i class="icon-eye-close"></i> Black out</button>					 Black out any personal information.</div>				</div><br/>				<div class="row-fluid">					<div class="span12"> <button id="clear" class="btn" type="button"><i class="icon-remove"></i> Clear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>					 Remove all boxes.</div>				</div>				</div>			</div>',step3='<div id="step3" style="display:none;">	<div class="row-fluid">	<div class="span6" >		<form>	    <div class="row-fluid">tell us where you would improve or change	        <br />	    <label>Description</label>	    <div class="accordion" id="envInfo" style="max-height: 350px;overflow-y: scroll;}">	      <div class="accordion-group">	          <div class="accordion-heading">	              <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseOne">	                  User info</a>	          </div>	          <div id="collapseOne" class="accordion-body collapse">	              <div class="accordion-inner userInfo"></div>	          </div>	      </div>	          <div class="accordion-group">	              <div class="accordion-heading">	                  <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseTwo">	                      Page info </a>	              </div>	              <div id="collapseTwo" class="accordion-body collapse">	                  <div class="accordion-inner pageInfo"></div>	              </div>	          </div>	          <div class="accordion-group">	          <div class="accordion-heading">	              <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseThree">	                 Browser info </a>	          </div>	          <div id="collapseThree" class="accordion-body collapse">	              <div class="accordion-inner browserInfo"></div>	          </div>	      </div>	    </div>	    </div>	   </form>		</div>		<div class="span6">			<div id="screenPreview">					<b>Screenshot</b>					<div id="thumbProgress" class="progress progress-striped active">						<div class="bar" style="width: 100%;"></div>					</div>	 				<div id="screenshootImg" >					</div>			</div>		</div>		</div>	</div>',$("body").append(t),$("#reportDialog").append(step1+step2+step3)}function cleanup(){hideCanvas(),$("#feedback").show(),$("#step1").show(),$("#step2").hide(),$("#step3").hide(),$("#feedback").unbind("click").on("click",function(){goStep1()}),$(".pageInfo").empty(),$(".userInfo").empty(),$(".browserInfo").empty(),cleanThumbElement()}function goStep1(){$("#feedback").hide(),$("#reportDialog").dialog({width:500,modal:!1,resizable:!1,zIndex:1050,close:function(){cleanup()}}),$(".ui-dialog ").css("position","fixed"),$("#reportDialog").dialog("option","position","center"),$("#step2").is(":visible")&&($("#step2").hide("blind",{direction:"vertical"},500),$("#step1").show("blind",{direction:"vertical"},500)),setStep1Buttons(),$(".ui-dialog-titlebar").css("cursor","auto")}function goStep2(){var t=$("#reportDialog");t.dialog({width:500}),t.dialog("widget").animate({left:$(window).width()-550,top:$(window).height()-350},1e3),$("#step1").is(":visible")?(report.description=$("#usrDescription").val(),$("#step1").hide("blind",{direction:"vertical"},500)):$("#step3").is(":visible")&&$("#step3").hide("blind",{direction:"vertical"},500),$("#step2").show("blind",{direction:"vertical"},500),setStep2Buttons(),drawInCanvas()}function goStep3(){$("#reportDialog").dialog("widget").animate({left:$(window).width()/2-450,top:$(window).height()/2-260},1e3),$("#reportDialog").dialog({width:900}),$("#step2").hide("blind",{direction:"vertical"},500),$("#step3").show("blind",{direction:"vertical"},500),setStep3Buttons(),setTimeout(function(){takeScreenShot()},1e3)}function setStep1Buttons(){$("#reportDialog").dialog({buttons:[{text:"Next","class":"btn",click:function(){goStep2()}}]})}function setStep2Buttons(){$("#reportDialog").dialog({buttons:[{text:"Back","class":"btn",click:function(){goStep1(),$("#reportDialog").dialog("widget").animate({left:$(window).width()/2-250,top:$(window).height()/2-200},1e3)}},{text:"Next","class":"btn",click:function(){goStep3()}}]})}function setStep3Buttons(){$("#reportDialog").dialog({buttons:[{text:"Back","class":"btn",click:function(){goStep2(),cleanThumbElement()}},{text:"Next","class":"btn",click:function(){saveReport()}}]})}function isCanvasSupported(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}function drawViewportBox(){context.strokeStyle="red";var t=$(window);context.strokeRect(t.scrollLeft(),t.scrollTop(),t.width(),t.height())}function makeThumbnail(){var t=$(window),e=new Image;e.src=report.screenshot,$("body").append('<canvas id="thumbCanvas"></canvas>');var n=$("#thumbCanvas");n[0].width=t.width(),n[0].height=t.height(),$("body").append('<canvas id="thumbCanvasBlank" style="display:none"></canvas>');var r=$("#thumbCanvasBlank");r[0].width=t.width(),r[0].height=t.height(),startCrop(e,t,n,r)}function startCrop(t,e,n,r){var o=n[0].getContext("2d");o.drawImage(t,e.scrollLeft(),e.scrollTop(),e.width(),e.height(),0,0,e.width(),e.height()),n[0].toDataURL()==r[0].toDataURL()?setTimeout(function(){startCrop(t,e,n,r)},500):finishCrop(t,e,n,r)}function finishCrop(t,e,n,r){if(report.thumb=n[0].toDataURL(),n.hide(),$("#thumbProgress").hide(),n[0].toDataURL()!=r[0].toDataURL())$("#screenshootImg").append("<img class='screenShotCanvas' src='"+report.screenshot+"' alt='Page Screenshot' width='400' >");else{var o="There was a problem creating the screenshot :(<br/> Don't worry, submit your feedback anyway";$("#screenshootImg").append(o)}}function takeScreenShot(){drawViewportBox();var t=$(window),e=t.scrollTop(),n=t.scrollLeft();$(".ui-dialog").attr("data-html2canvas-ignore","true"),html2canvas($("body"),{onrendered:function(r){var o=r.toDataURL();t.scrollTop(e),t.scrollLeft(n),report.screenshot=o,hideCanvas(),fillInInfo(),makeThumbnail()}})}function hideCanvas(){$("#canvas").hide(),$("#myCanvas").hide()}function cleanThumbElement(){$("#screenshootImg").empty(),$("#thumbProgress").show()}function fillInInfo(){writeUserInfo(),writePageInfo(),writeBrowserInfo()}function stripTags(t){return t.replace(/<\/?[^>]+>/gi,"")}function dumpVars(t,e,n){jQuery.each(t,function(t,r){"function"!=typeof r&&-1==jQuery.inArray(t,n)&&""!=r&&$(e).append(t+" : "+r+"<br/>")})}function showPlugins(){for(var t=navigator.plugins.length,e="",n=0;t>n;n++)e+='<a rel="tooltip" href="#" data-original-title="'+stripTags(navigator.plugins[n].description)+'" data-triger="hover" data-placement="right">'+navigator.plugins[n].name+"</a>",e+=" , ",e+=navigator.plugins[n].filename,navigator.plugins[n].version&&(e+=" | ",e+=navigator.plugins[n].version),e+="<br>";return e}function get_cookies_array(){var t={};if(document.cookie&&""!=document.cookie)for(var e=document.cookie.split(";"),n=0;e.length>n;n++){var r=e[n].split("=");r[0]=r[0].replace(/^ /,""),t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}function writeBrowserInfo(){var t=$(".browserInfo");t.append("<h4>Browser version:</h4>"),dumpVars(jQuery.browser,".browserInfo"),report.browserInfo=jQuery.browser,t.append("<h4>Operating System: </h4>"),dumpVars(navigator,".browserInfo",["plugins","mimeTypes"]),report.navigator=navigator,t.append("<h4>Installed Plugins: </h4>"+showPlugins())}function writePageInfo(){var t=$(".pageInfo");t.append("<h4>Page Url:</h4>"),dumpVars(window.location,".pageInfo",["ancestorOrigins"]),report.location=window.location;var e=$.base64.encode($("html").clone().html());t.append("<h4>Page Structure:</h4>").append("<div class='row-fluid'><textarea rows='4' class='span12'>"+e+"</textarea></div>"),report.encodedHtml=e}function writeUserInfo(){var t=$(".userInfo");null!=report.user&&(t.append("<h4>User Info:</h4>"),dumpVars(report.user,".userInfo"));var e=get_cookies_array();$.isEmptyObject(e)||(t.append("<h4>Cookies:</h4>"),dumpVars(e,".userInfo"),report.cookies=e)}function drawInCanvas(){function t(){var t=r(),e=o();a.width(t),a.height(e),s.attr({width:t,height:e}),context.fillStyle=l,context.fillRect(0,0,s.width(),s.height()),n()}function e(){a.width(0),a.height(0),s.attr({width:0,height:0})}function n(){context.clearRect(0,0,s.width(),s.height()),context.fillStyle=l,context.fillRect(0,0,s.width(),s.height())}function r(){return document.documentElement.offsetWidth}function o(){var t=document;return Math.max(Math.max(t.body.scrollHeight,t.documentElement.scrollHeight),Math.max(t.body.offsetHeight,t.documentElement.offsetHeight),Math.max(t.body.clientHeight,t.documentElement.clientHeight))}var i='<canvas id="myCanvas"></canvas><div id="canvas"></div>';$("body").append(i),$("#canvas, #myCanvas").css({position:"absolute",left:"0px",top:"0px",display:"block",cursor:"default","z-index":"1040"});var a=$("#canvas"),s=$("#myCanvas");context=s[0].getContext("2d");var l="rgba(0, 0, 0, 0.295)",c="rgba(0, 0, 0, 1)",d="rgba(0, 0, 0, 0)";t();var h="highlight";$(window).resize(function(){e(),t()}),$.extend($.ui.boxer,{defaults:$.extend({},$.ui.mouse.defaults,{appendTo:"body",distance:0})}),$("#highlight").on("click",function(){$("#reportDialog button").removeClass("btn-primary"),$(this).addClass("btn-primary"),h="highlight"}),$("#block").on("click",function(){$("#reportDialog button").removeClass("btn-primary"),$(this).addClass("btn-primary"),h="block"}),$("#clear").on("click",function(){n()}),$.widget("ui.boxer",$.ui.mouse,{options:{appendTo:"body",distance:0},_init:function(){this.element.addClass("ui-boxer"),this.dragged=!1,this._mouseInit(),this.helper=$(document.createElement("div")).css({border:"1px dotted red"}).addClass("ui-boxer-helper")},_mouseStart:function(t){if(this.opos=[t.pageX,t.pageY],!this.options.disabled){var e=this.options;this._trigger("start",t),$(e.appendTo).append(this.helper),this.helper.css({position:"absolute",left:t.clientX,top:t.clientY,width:0,height:0,"z-index":1040}),"highlight"==h?this.helper.css({background:d}):this.helper.css({background:l})}},_mouseDrag:function(t){if(this.dragged=!0,!this.options.disabled){this.options;var e=this.opos[0],n=this.opos[1],r=t.pageX,o=t.pageY;if(e>r){var i=r;r=e,e=i}if(n>o){var i=o;o=n,n=i}return this.helper.css({left:e,top:n,width:r-e,height:o-n}),this._trigger("drag",t),!1}},_mouseStop:function(){this.dragged=!1,this.options,this.helper.clone();var t=this.helper.offset().top,e=this.helper.offset().left,n=this.helper.width(),r=this.helper.height();return"highlight"==h?context.clearRect(e,t,n,r):(context.fillStyle=c,context.fillRect(e,t,n,r)),this.helper.remove(),!1}}),$("#canvas").boxer({stop:function(t,e){e.box.addClass(h)}})}var report=[];(function(){var t,e;jQuery.uaMatch=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||0>t.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}},t=jQuery.uaMatch(navigator.userAgent),e={},t.browser&&(e[t.browser]=!0,e.version=t.version),e.chrome?e.webkit=!0:e.webkit&&(e.safari=!0),jQuery.browser=e,jQuery.sub=function(){function t(e,n){return new t.fn.init(e,n)}jQuery.extend(!0,t,this),t.superclass=this,t.fn=t.prototype=this(),t.fn.constructor=t,t.sub=this.sub,t.fn.init=function(n,r){return r&&r instanceof jQuery&&!(r instanceof t)&&(r=t(r)),jQuery.fn.init.call(this,n,r,e)},t.fn.init.prototype=t.fn;var e=t(document);return t}})(),function(t,e,n){function r(e){c.logging&&t.console&&t.console.log&&t.console.log(e)}function o(t,e,n,r,o,i){var a,s,l,d,h=c.Util.getCSS(e,t,o);if(1===h.length&&(d=h[0],h=[],h[0]=d,h[1]=d),-1!==(""+h[0]).indexOf("%"))l=parseFloat(h[0])/100,s=n.width*l,"backgroundSize"!==t&&(s-=(i||r).width*l);else if("backgroundSize"===t)if("auto"===h[0])s=r.width;else if(h[0].match(/contain|cover/)){var u=c.Util.resizeBounds(r.width,r.height,n.width,n.height,h[0]);s=u.width,a=u.height}else s=parseInt(h[0],10);else s=parseInt(h[0],10);return"auto"===h[1]?a=s/r.width*r.height:-1!==(""+h[1]).indexOf("%")?(l=parseFloat(h[1])/100,a=n.height*l,"backgroundSize"!==t&&(a-=(i||r).height*l)):a=parseInt(h[1],10),[s,a]}function i(t){return{zindex:t,children:[]}}function a(t,e){var n=[];return{storage:n,width:t,height:e,clip:function(){n.push({type:"function",name:"clip",arguments:arguments})},translate:function(){n.push({type:"function",name:"translate",arguments:arguments})},fill:function(){n.push({type:"function",name:"fill",arguments:arguments})},save:function(){n.push({type:"function",name:"save",arguments:arguments})},restore:function(){n.push({type:"function",name:"restore",arguments:arguments})},fillRect:function(){n.push({type:"function",name:"fillRect",arguments:arguments})},createPattern:function(){n.push({type:"function",name:"createPattern",arguments:arguments})},drawShape:function(){var t=[];return n.push({type:"function",name:"drawShape",arguments:t}),{moveTo:function(){t.push({name:"moveTo",arguments:arguments})},lineTo:function(){t.push({name:"lineTo",arguments:arguments})},arcTo:function(){t.push({name:"arcTo",arguments:arguments})},bezierCurveTo:function(){t.push({name:"bezierCurveTo",arguments:arguments})},quadraticCurveTo:function(){t.push({name:"quadraticCurveTo",arguments:arguments})}}},drawImage:function(){n.push({type:"function",name:"drawImage",arguments:arguments})},fillText:function(){n.push({type:"function",name:"fillText",arguments:arguments})},setVariable:function(t,e){n.push({type:"variable",name:t,arguments:e})}}}var s,l,c={};c.Util={},c.Util.trimText=function(t){return function(e){return t?t.apply(e):((e||"")+"").replace(/^\s+|\s+$/g,"")}}(String.prototype.trim),c.Util.parseBackgroundImage=function(t){var e,n,r,o,i,a,s,l,c=" \r\n	",d=[],h=0,u=0,p=function(){e&&('"'===n.substr(0,1)&&(n=n.substr(1,n.length-2)),n&&l.push(n),"-"===e.substr(0,1)&&(o=e.indexOf("-",1)+1)>0&&(r=e.substr(0,o),e=e.substr(o)),d.push({prefix:r,method:e.toLowerCase(),value:i,args:l})),l=[],e=r=n=i=""};p();for(var g=0,f=t.length;f>g;g++)if(a=t[g],!(0===h&&c.indexOf(a)>-1)){switch(a){case'"':s?s===a&&(s=null):s=a;break;case"(":if(s)break;if(0===h){h=1,i+=a;continue}u++;break;case")":if(s)break;if(1===h){if(0===u){h=0,i+=a,p();continue}u--}break;case",":if(s)break;if(0===h){p();continue}if(1===h&&0===u&&!e.match(/^url$/i)){l.push(n),n="",i+=a;continue}}i+=a,0===h?e+=a:n+=a}return p(),d},c.Util.Bounds=function(t){var e,r={};return t.getBoundingClientRect?(e=t.getBoundingClientRect(),r.top=e.top,r.bottom=e.bottom||e.top+e.height,r.left=e.left,r.width=e.width||e.right-e.left,r.height=e.height||e.bottom-e.top,r):n},c.Util.getCSS=function(t,r,o){function i(e,n){var r,o=t.runtimeStyle&&t.runtimeStyle[e],i=t.style;return!/^-?[0-9]+\.?[0-9]*(?:px)?$/i.test(n)&&/^-?\d/.test(n)&&(r=i.left,o&&(t.runtimeStyle.left=t.currentStyle.left),i.left="fontSize"===e?"1em":n||0,n=i.pixelLeft+"px",i.left=r,o&&(t.runtimeStyle.left=o)),/^(thin|medium|thick)$/i.test(n)?n:Math.round(parseFloat(n))+"px"}var a,d=r.match(/^background(Size|Position)$/);if(s!==t&&(l=e.defaultView.getComputedStyle(t,null)),a=l[r],d)if(a=(a||"").split(","),a=a[o||0]||a[0]||"auto",a=c.Util.trimText(a).split(" "),"backgroundSize"!==r||a[0]&&!a[0].match(/cover|contain|auto/)){if(a[0]=-1===a[0].indexOf("%")?i(r+"X",a[0]):a[0],a[1]===n){if("backgroundSize"===r)return a[1]="auto",a;a[1]=a[0]}a[1]=-1===a[1].indexOf("%")?i(r+"Y",a[1]):a[1]}else;else if(/border(Top|Bottom)(Left|Right)Radius/.test(r)){var h=a.split(" ");1>=h.length&&(h[1]=h[0]),h[0]=parseInt(h[0],10),h[1]=parseInt(h[1],10),a=h}return a},c.Util.resizeBounds=function(t,e,n,r,o){var i,a,s=n/r,l=t/e;return o&&"auto"!==o?l>s^"contain"===o?(a=r,i=r*l):(i=n,a=n/l):(i=n,a=r),{width:i,height:a}},c.Util.BackgroundPosition=function(t,e,n,r,i){var a=o("backgroundPosition",t,e,n,r,i);return{left:a[0],top:a[1]}},c.Util.BackgroundSize=function(t,e,n,r){var i=o("backgroundSize",t,e,n,r);return{width:i[0],height:i[1]}},c.Util.Extend=function(t,e){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},c.Util.Children=function(t){var e;try{e=t.nodeName&&"IFRAME"===t.nodeName.toUpperCase()?t.contentDocument||t.contentWindow.document:function(t){var e=[];return null!==t&&function(t,e){var r=t.length,o=0;if("number"==typeof e.length)for(var i=e.length;i>o;o++)t[r++]=e[o];else for(;e[o]!==n;)t[r++]=e[o++];return t.length=r,t}(e,t),e}(t.childNodes)}catch(o){r("html2canvas.Util.Children failed with exception: "+o.message),e=[]}return e},c.Util.Font=function(){var t={};return function(e,r,o){if(t[e+"-"+r]!==n)return t[e+"-"+r];var i,a,s,l=o.createElement("div"),c=o.createElement("img"),d=o.createElement("span"),h="Hidden Text";return l.style.visibility="hidden",l.style.fontFamily=e,l.style.fontSize=r,l.style.margin=0,l.style.padding=0,o.body.appendChild(l),c.src="data:image/gif;base64,R0lGODlhAQABAIABAP///wAAACwAAAAAAQABAAACAkQBADs=",c.width=1,c.height=1,c.style.margin=0,c.style.padding=0,c.style.verticalAlign="baseline",d.style.fontFamily=e,d.style.fontSize=r,d.style.margin=0,d.style.padding=0,d.appendChild(o.createTextNode(h)),l.appendChild(d),l.appendChild(c),i=c.offsetTop-d.offsetTop+1,l.removeChild(d),l.appendChild(o.createTextNode(h)),l.style.lineHeight="normal",c.style.verticalAlign="super",a=c.offsetTop-l.offsetTop+1,s={baseline:i,lineWidth:1,middle:a},t[e+"-"+r]=s,o.body.removeChild(l),s}}(),function(){c.Generate={};var t=[/^(-webkit-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-linear-gradient)\(([a-z\s]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-gradient)\((linear|radial),\s((?:\d{1,3}%?)\s(?:\d{1,3}%?),\s(?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)\-]+)\)$/,/^(-moz-linear-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?))([\w\d\.\s,%\(\)]+)\)$/,/^(-webkit-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/,/^(-moz-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s?([a-z\-]*)([\w\d\.\s,%\(\)]+)\)$/,/^(-o-radial-gradient)\(((?:\d{1,3}%?)\s(?:\d{1,3}%?)),\s(\w+)\s([a-z\-]+)([\w\d\.\s,%\(\)]+)\)$/];c.Generate.parseGradient=function(e,n){var r,o,i,a,s,l,c,d,h,u,p,g,f=t.length;for(o=0;f>o&&!(i=e.match(t[o]));o+=1);if(i)switch(i[1]){case"-webkit-linear-gradient":case"-o-linear-gradient":if(r={type:"linear",x0:null,y0:null,x1:null,y1:null,colorStops:[]},s=i[2].match(/\w+/g))for(l=s.length,o=0;l>o;o+=1)switch(s[o]){case"top":r.y0=0,r.y1=n.height;break;case"right":r.x0=n.width,r.x1=0;break;case"bottom":r.y0=n.height,r.y1=0;break;case"left":r.x0=0,r.x1=n.width}if(null===r.x0&&null===r.x1&&(r.x0=r.x1=n.width/2),null===r.y0&&null===r.y1&&(r.y0=r.y1=n.height/2),s=i[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,c=1/Math.max(l-1,1),o=0;l>o;o+=1)d=s[o].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),d[2]?(a=parseFloat(d[2]),a/="%"===d[3]?100:n.width):a=o*c,r.colorStops.push({color:d[1],stop:a});break;case"-webkit-gradient":if(r={type:"radial"===i[2]?"circle":i[2],x0:0,y0:0,x1:0,y1:0,colorStops:[]},s=i[3].match(/(\d{1,3})%?\s(\d{1,3})%?,\s(\d{1,3})%?\s(\d{1,3})%?/),s&&(r.x0=s[1]*n.width/100,r.y0=s[2]*n.height/100,r.x1=s[3]*n.width/100,r.y1=s[4]*n.height/100),s=i[4].match(/((?:from|to|color-stop)\((?:[0-9\.]+,\s)?(?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)\))+/g))for(l=s.length,o=0;l>o;o+=1)d=s[o].match(/(from|to|color-stop)\(([0-9\.]+)?(?:,\s)?((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\)/),a=parseFloat(d[2]),"from"===d[1]&&(a=0),"to"===d[1]&&(a=1),r.colorStops.push({color:d[3],stop:a});break;case"-moz-linear-gradient":if(r={type:"linear",x0:0,y0:0,x1:0,y1:0,colorStops:[]},s=i[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),s&&(r.x0=s[1]*n.width/100,r.y0=s[2]*n.height/100,r.x1=n.width-r.x0,r.y1=n.height-r.y0),s=i[3].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}%)?)+/g))for(l=s.length,c=1/Math.max(l-1,1),o=0;l>o;o+=1)d=s[o].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%)?/),d[2]?(a=parseFloat(d[2]),d[3]&&(a/=100)):a=o*c,r.colorStops.push({color:d[1],stop:a});break;case"-webkit-radial-gradient":case"-moz-radial-gradient":case"-o-radial-gradient":if(r={type:"circle",x0:0,y0:0,x1:n.width,y1:n.height,cx:0,cy:0,rx:0,ry:0,colorStops:[]},s=i[2].match(/(\d{1,3})%?\s(\d{1,3})%?/),s&&(r.cx=s[1]*n.width/100,r.cy=s[2]*n.height/100),s=i[3].match(/\w+/),d=i[4].match(/[a-z\-]*/),s&&d)switch(d[0]){case"farthest-corner":case"cover":case"":h=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.cy,2)),u=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.y1-r.cy,2)),p=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.y1-r.cy,2)),g=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.cy,2)),r.rx=r.ry=Math.max(h,u,p,g);break;case"closest-corner":h=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.cy,2)),u=Math.sqrt(Math.pow(r.cx,2)+Math.pow(r.y1-r.cy,2)),p=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.y1-r.cy,2)),g=Math.sqrt(Math.pow(r.x1-r.cx,2)+Math.pow(r.cy,2)),r.rx=r.ry=Math.min(h,u,p,g);break;case"farthest-side":"circle"===s[0]?r.rx=r.ry=Math.max(r.cx,r.cy,r.x1-r.cx,r.y1-r.cy):(r.type=s[0],r.rx=Math.max(r.cx,r.x1-r.cx),r.ry=Math.max(r.cy,r.y1-r.cy));break;case"closest-side":case"contain":"circle"===s[0]?r.rx=r.ry=Math.min(r.cx,r.cy,r.x1-r.cx,r.y1-r.cy):(r.type=s[0],r.rx=Math.min(r.cx,r.x1-r.cx),r.ry=Math.min(r.cy,r.y1-r.cy))}if(s=i[5].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\)(?:\s\d{1,3}(?:%|px))?)+/g))for(l=s.length,c=1/Math.max(l-1,1),o=0;l>o;o+=1)d=s[o].match(/((?:rgb|rgba)\(\d{1,3},\s\d{1,3},\s\d{1,3}(?:,\s[0-9\.]+)?\))\s*(\d{1,3})?(%|px)?/),d[2]?(a=parseFloat(d[2]),a/="%"===d[3]?100:n.width):a=o*c,r.colorStops.push({color:d[1],stop:a})}return r},c.Generate.Gradient=function(t,n){if(0!==n.width&&0!==n.height){var o,i,a,s,l=e.createElement("canvas"),d=l.getContext("2d");if(l.width=n.width,l.height=n.height,o=c.Generate.parseGradient(t,n))if("linear"===o.type){for(i=d.createLinearGradient(o.x0,o.y0,o.x1,o.y1),a=0,s=o.colorStops.length;s>a;a+=1)try{i.addColorStop(o.colorStops[a].stop,o.colorStops[a].color)}catch(h){r(["failed to add color stop: ",h,"; tried to add: ",o.colorStops[a],"; stop: ",a,"; in: ",t])}d.fillStyle=i,d.fillRect(0,0,n.width,n.height)}else if("circle"===o.type){for(i=d.createRadialGradient(o.cx,o.cy,0,o.cx,o.cy,o.rx),a=0,s=o.colorStops.length;s>a;a+=1)try{i.addColorStop(o.colorStops[a].stop,o.colorStops[a].color)}catch(h){r(["failed to add color stop: ",h,"; tried to add: ",o.colorStops[a],"; stop: ",a,"; in: ",t])}d.fillStyle=i,d.fillRect(0,0,n.width,n.height)}else if("ellipse"===o.type){var u=e.createElement("canvas"),p=u.getContext("2d"),g=Math.max(o.rx,o.ry),f=2*g;for(u.width=u.height=f,i=p.createRadialGradient(o.rx,o.ry,0,o.rx,o.ry,g),a=0,s=o.colorStops.length;s>a;a+=1)try{i.addColorStop(o.colorStops[a].stop,o.colorStops[a].color)}catch(h){r(["failed to add color stop: ",h,"; tried to add: ",o.colorStops[a],"; stop: ",a,"; in: ",t])}p.fillStyle=i,p.fillRect(0,0,f,f),d.fillStyle=o.colorStops[a-1].color,d.fillRect(0,0,l.width,l.height),d.drawImage(u,o.cx-o.rx,o.cy-o.ry,2*o.rx,2*o.ry)}return l}},c.Generate.ListAlpha=function(t){var e,n="";do e=t%26,n=String.fromCharCode(e+64)+n,t/=26;while(26*t>26);return n},c.Generate.ListRoman=function(t){var e,n=["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"],r=[1e3,900,500,400,100,90,50,40,10,9,5,4,1],o="",i=n.length;if(0>=t||t>=4e3)return t;for(e=0;i>e;e+=1)for(;t>=r[e];)t-=r[e],o+=n[e];return o}}(),c.Parse=function(o,s){function l(){return Math.max(Math.max(se.body.scrollWidth,se.documentElement.scrollWidth),Math.max(se.body.offsetWidth,se.documentElement.offsetWidth),Math.max(se.body.clientWidth,se.documentElement.clientWidth))}function d(){return Math.max(Math.max(se.body.scrollHeight,se.documentElement.scrollHeight),Math.max(se.body.offsetHeight,se.documentElement.offsetHeight),Math.max(se.body.clientHeight,se.documentElement.clientHeight))}function h(t,e){var n=parseInt(he(t,e),10);return isNaN(n)?0:n}function u(t,e,n,r,o,i){"transparent"!==i&&(t.setVariable("fillStyle",i),t.fillRect(e,n,r,o),ae+=1)}function p(t,e){switch(e){case"lowercase":return t.toLowerCase();case"capitalize":return t.replace(/(^|\s|:|-|\(|\))([a-z])/g,function(t,e,r){return t.length>0?e+r.toUpperCase():n});case"uppercase":return t.toUpperCase();default:return t}}function g(t){return/^(normal|none|0px)$/.test(t)}function f(t,e,n,r){null!==t&&c.Util.trimText(t).length>0&&(r.fillText(t,e,n),ae+=1)}function m(t,e,r,o){var i=!1,a=he(e,"fontWeight"),s=he(e,"fontFamily"),l=he(e,"fontSize");switch(parseInt(a,10)){case 401:a="bold";break;case 400:a="normal"}return t.setVariable("fillStyle",o),t.setVariable("font",[he(e,"fontStyle"),he(e,"fontVariant"),a,l,s].join(" ")),t.setVariable("textAlign",i?"right":"left"),"none"!==r?c.Util.Font(s,l,se):n}function v(t,e,n,r,o){switch(e){case"underline":u(t,n.left,Math.round(n.top+r.baseline+r.lineWidth),n.width,1,o);break;case"overline":u(t,n.left,Math.round(n.top),n.width,1,o);break;case"line-through":u(t,n.left,Math.ceil(n.top+r.middle+r.lineWidth),n.width,1,o)}}function b(t,e,n,r){var o;if(le.rangeBounds)("none"!==n||0!==c.Util.trimText(e).length)&&(o=w(e,t.node,t.textOffset)),t.textOffset+=e.length;else if(t.node&&"string"==typeof t.node.nodeValue){var i=r?t.node.splitText(e.length):null;o=y(t.node),t.node=i}return o}function w(t,e,n){var r=se.createRange();return r.setStart(e,n),r.setEnd(e,n+t.length),r.getBoundingClientRect()}function y(t){var e=t.parentNode,n=se.createElement("wrapper"),r=t.cloneNode(!0);n.appendChild(t.cloneNode(!0)),e.replaceChild(n,t);var o=c.Util.Bounds(n);return e.replaceChild(r,n),o}function x(t,e,n){var r,o,i=n.ctx,a=he(t,"color"),l=he(t,"textDecoration"),d=he(t,"textAlign"),h={node:e,textOffset:0};c.Util.trimText(e.nodeValue).length>0&&(e.nodeValue=p(e.nodeValue,he(t,"textTransform")),d=d.replace(["-webkit-auto"],["auto"]),o=!s.letterRendering&&/^(left|right|justify|auto)$/.test(d)&&g(he(t,"letterSpacing"))?e.nodeValue.split(/(\b| )/):e.nodeValue.split(""),r=m(i,t,l,a),s.chinese&&o.forEach(function(t,e){/.*[\u4E00-\u9FA5].*$/.test(t)&&(t=t.split(""),t.unshift(e,1),o.splice.apply(o,t))}),o.forEach(function(t,e){var n=b(h,t,l,o.length-1>e);n&&(f(t,n.left,n.bottom,i),v(i,l,n,r,a))}))}function C(t,e){var n,r,o=se.createElement("boundelement");return o.style.display="inline",n=t.style.listStyleType,t.style.listStyleType="none",o.appendChild(se.createTextNode(e)),t.insertBefore(o,t.firstChild),r=c.Util.Bounds(o),t.removeChild(o),t.style.listStyleType=n,r}function k(t){var e=-1,n=1,r=t.parentNode.childNodes;if(t.parentNode){for(;r[++e]!==t;)1===r[e].nodeType&&n++;return n}return-1}function S(t,e){var n,r=k(t);switch(e){case"decimal":n=r;break;case"decimal-leading-zero":n=1===(""+r).length?r="0"+(""+r):""+r;break;case"upper-roman":n=c.Generate.ListRoman(r);break;case"lower-roman":n=c.Generate.ListRoman(r).toLowerCase();break;case"lower-alpha":n=c.Generate.ListAlpha(r).toLowerCase();break;case"upper-alpha":n=c.Generate.ListAlpha(r)}return n+=". "}function I(t,e,n){var r,o,i,a=e.ctx,s=he(t,"listStyleType");if(/^(decimal|decimal-leading-zero|upper-alpha|upper-latin|upper-roman|lower-alpha|lower-greek|lower-latin|lower-roman)$/i.test(s)){if(o=S(t,s),i=C(t,o),m(a,t,"none",he(t,"color")),"inside"!==he(t,"listStylePosition"))return;a.setVariable("textAlign","left"),r=n.left,f(o,r,i.bottom,a)}}function $(t){var e=o[t];return e&&e.succeeded===!0?e.img:!1}function T(t,e){var n=Math.max(t.left,e.left),r=Math.max(t.top,e.top),o=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height);return{left:n,top:r,width:o-n,height:i-r}}function R(t,e){var n;return e?"auto"!==t?(n=i(t),e.children.push(n),n):e:n=i(0)}function M(t,e,n,r,o){var i=h(e,"paddingLeft"),a=h(e,"paddingTop"),s=h(e,"paddingRight"),l=h(e,"paddingBottom");V(t,n,0,0,n.width,n.height,r.left+i+o[3].width,r.top+a+o[0].width,r.width-(o[1].width+o[3].width+i+s),r.height-(o[0].width+o[2].width+a+l))}function E(t){return["Top","Right","Bottom","Left"].map(function(e){return{width:h(t,"border"+e+"Width"),color:he(t,"border"+e+"Color")}})}function L(t){return["TopLeft","TopRight","BottomRight","BottomLeft"].map(function(e){return he(t,"border"+e+"Radius")})}function U(t,e,n,r){var o=function(t,e,n){return{x:t.x+(e.x-t.x)*n,y:t.y+(e.y-t.y)*n}};return{start:t,startControl:e,endControl:n,end:r,subdivide:function(i){var a=o(t,e,i),s=o(e,n,i),l=o(n,r,i),c=o(a,s,i),d=o(s,l,i),h=o(c,d,i);return[U(t,a,c,h),U(h,d,l,r)]},curveTo:function(t){t.push(["bezierCurve",e.x,e.y,n.x,n.y,r.x,r.y])},curveToReversed:function(r){r.push(["bezierCurve",n.x,n.y,e.x,e.y,t.x,t.y])}}}function B(t,e,n,r,o,i,a){e[0]>0||e[1]>0?(t.push(["line",r[0].start.x,r[0].start.y]),r[0].curveTo(t),r[1].curveTo(t)):t.push(["line",i,a]),(n[0]>0||n[1]>0)&&t.push(["line",o[0].start.x,o[0].start.y])}function O(t,e,n,r,o,i,a){var s=[];return e[0]>0||e[1]>0?(s.push(["line",r[1].start.x,r[1].start.y]),r[1].curveTo(s)):s.push(["line",t.c1[0],t.c1[1]]),n[0]>0||n[1]>0?(s.push(["line",i[0].start.x,i[0].start.y]),i[0].curveTo(s),s.push(["line",a[0].end.x,a[0].end.y]),a[0].curveToReversed(s)):(s.push(["line",t.c2[0],t.c2[1]]),s.push(["line",t.c3[0],t.c3[1]])),e[0]>0||e[1]>0?(s.push(["line",o[1].end.x,o[1].end.y]),o[1].curveToReversed(s)):s.push(["line",t.c4[0],t.c4[1]]),s}function A(t,e,n){var r=t.left,o=t.top,i=t.width,a=t.height,s=e[0][0],l=e[0][1],c=e[1][0],d=e[1][1],h=e[2][0],u=e[2][1],p=e[3][0],g=e[3][1],f=i-c,m=a-h,v=i-u,b=a-g;return{topLeftOuter:ge(r,o,s,l).topLeft.subdivide(.5),topLeftInner:ge(r+n[3].width,o+n[0].width,Math.max(0,s-n[3].width),Math.max(0,l-n[0].width)).topLeft.subdivide(.5),topRightOuter:ge(r+f,o,c,d).topRight.subdivide(.5),topRightInner:ge(r+Math.min(f,i+n[3].width),o+n[0].width,f>i+n[3].width?0:c-n[3].width,d-n[0].width).topRight.subdivide(.5),bottomRightOuter:ge(r+v,o+m,u,h).bottomRight.subdivide(.5),bottomRightInner:ge(r+Math.min(v,i+n[3].width),o+Math.min(m,a+n[0].width),Math.max(0,u-n[1].width),Math.max(0,h-n[2].width)).bottomRight.subdivide(.5),bottomLeftOuter:ge(r,o+b,p,g).bottomLeft.subdivide(.5),bottomLeftInner:ge(r+n[3].width,o+b,Math.max(0,p-n[3].width),Math.max(0,g-n[2].width)).bottomLeft.subdivide(.5)}
}function z(t,e,n,r,o){var i=he(t,"backgroundClip"),a=[];switch(i){case"content-box":case"padding-box":B(a,r[0],r[1],e.topLeftInner,e.topRightInner,o.left+n[3].width,o.top+n[0].width),B(a,r[1],r[2],e.topRightInner,e.bottomRightInner,o.left+o.width-n[1].width,o.top+n[0].width),B(a,r[2],r[3],e.bottomRightInner,e.bottomLeftInner,o.left+o.width-n[1].width,o.top+o.height-n[2].width),B(a,r[3],r[0],e.bottomLeftInner,e.topLeftInner,o.left+n[3].width,o.top+o.height-n[2].width);break;default:B(a,r[0],r[1],e.topLeftOuter,e.topRightOuter,o.left,o.top),B(a,r[1],r[2],e.topRightOuter,e.bottomRightOuter,o.left+o.width,o.top),B(a,r[2],r[3],e.bottomRightOuter,e.bottomLeftOuter,o.left+o.width,o.top+o.height),B(a,r[3],r[0],e.bottomLeftOuter,e.topLeftOuter,o.left,o.top+o.height)}return a}function D(t,e,n){var r,o,i,a,s,l,c=e.left,d=e.top,h=e.width,u=e.height,p=L(t),g=A(e,p,n),f={clip:z(t,g,n,p,e),borders:[]};for(r=0;4>r;r++)if(n[r].width>0){switch(o=c,i=d,a=h,s=u-n[2].width,r){case 0:s=n[0].width,l=O({c1:[o,i],c2:[o+a,i],c3:[o+a-n[1].width,i+s],c4:[o+n[3].width,i+s]},p[0],p[1],g.topLeftOuter,g.topLeftInner,g.topRightOuter,g.topRightInner);break;case 1:o=c+h-n[1].width,a=n[1].width,l=O({c1:[o+a,i],c2:[o+a,i+s+n[2].width],c3:[o,i+s],c4:[o,i+n[0].width]},p[1],p[2],g.topRightOuter,g.topRightInner,g.bottomRightOuter,g.bottomRightInner);break;case 2:i=i+u-n[2].width,s=n[2].width,l=O({c1:[o+a,i+s],c2:[o,i+s],c3:[o+n[3].width,i],c4:[o+a-n[2].width,i]},p[2],p[3],g.bottomRightOuter,g.bottomRightInner,g.bottomLeftOuter,g.bottomLeftInner);break;case 3:a=n[3].width,l=O({c1:[o,i+s+n[2].width],c2:[o,i],c3:[o+a,i+n[0].width],c4:[o+a,i+s]},p[3],p[0],g.bottomLeftOuter,g.bottomLeftInner,g.topLeftOuter,g.topLeftInner)}f.borders.push({args:l,color:n[r].color})}return f}function N(t,e){var n=t.drawShape();return e.forEach(function(t,e){n[0===e?"moveTo":t[0]+"To"].apply(null,t.slice(1))}),n}function P(t,e,n){"transparent"!==n&&(t.setVariable("fillStyle",n),N(t,e),t.fill(),ae+=1)}function j(t,e,n){var o,i,a=se.createElement("valuewrap"),s=["lineHeight","textAlign","fontFamily","color","fontSize","paddingLeft","paddingTop","width","height","border","borderLeftWidth","borderTopWidth"];s.forEach(function(e){try{a.style[e]=he(t,e)}catch(n){r("html2canvas: Parse: Exception caught in renderFormValue: "+n.message)}}),a.style.borderColor="black",a.style.borderStyle="solid",a.style.display="block",a.style.position="absolute",(/^(submit|reset|button|text|password)$/.test(t.type)||"SELECT"===t.nodeName)&&(a.style.lineHeight=he(t,"height")),a.style.top=e.top+"px",a.style.left=e.left+"px",o="SELECT"===t.nodeName?(t.options[t.selectedIndex]||0).text:t.value,o||(o=t.placeholder),i=se.createTextNode(o),a.appendChild(i),de.appendChild(a),x(t,i,n),de.removeChild(a)}function V(t){t.drawImage.apply(t,Array.prototype.slice.call(arguments,1)),ae+=1}function F(r,o){var i=t.getComputedStyle(r,o);if(i&&i.content&&"none"!==i.content&&"-moz-alt-content"!==i.content){var a=i.content+"",s=a.substr(0,1);s===a.substr(a.length-1)&&s.match(/'|"/)&&(a=a.substr(1,a.length-2));var l="url"===a.substr(0,3),d=e.createElement(l?"img":"span");return d.className=ue+"-before "+ue+"-after",Object.keys(i).filter(G).forEach(function(t){i[t]!=n&&""!=i[t]&&(d.style[t]=i[t])}),l?d.src=c.Util.parseBackgroundImage(a)[0].args[0]:d.innerHTML=a,d}}function G(e){return isNaN(t.parseInt(e,10))}function H(t,e){var n=F(t,":before"),r=F(t,":after");(n||r)&&(n&&(t.className+=" "+ue+"-before",t.parentNode.insertBefore(n,t),ne(n,e,!0),t.parentNode.removeChild(n),t.className=t.className.replace(ue+"-before","").trim()),r&&(t.className+=" "+ue+"-after",t.appendChild(r),ne(r,e,!0),t.removeChild(r),t.className=t.className.replace(ue+"-after","").trim()))}function _(t,e,n,r){var o=Math.round(r.left+n.left),i=Math.round(r.top+n.top);t.createPattern(e),t.translate(o,i),t.fill(),t.translate(-o,-i)}function W(t,e,n,r,o,i,a,s){var l=[];l.push(["line",Math.round(o),Math.round(i)]),l.push(["line",Math.round(o+a),Math.round(i)]),l.push(["line",Math.round(o+a),Math.round(s+i)]),l.push(["line",Math.round(o),Math.round(s+i)]),N(t,l),t.save(),t.clip(),_(t,e,n,r),t.restore()}function Q(t,e,n){u(t,e.left,e.top,e.width,e.height,n)}function q(t,e,n,r,o){var i=c.Util.BackgroundSize(t,e,r,o),a=c.Util.BackgroundPosition(t,e,r,o,i),s=he(t,"backgroundRepeat").split(",").map(function(t){return t.trim()});switch(r=Y(r,i),s=s[o]||s[0]){case"repeat-x":W(n,r,a,e,e.left,e.top+a.top,99999,r.height);break;case"repeat-y":W(n,r,a,e,e.left+a.left,e.top,r.width,99999);break;case"no-repeat":W(n,r,a,e,e.left+a.left,e.top+a.top,r.width,r.height);break;default:_(n,r,a,{top:e.top,left:e.left,width:r.width,height:r.height})}}function X(t,e,n){for(var o,i=he(t,"backgroundImage"),a=c.Util.parseBackgroundImage(i),s=a.length;s--;)if(i=a[s],i.args&&0!==i.args.length){var l="url"===i.method?i.args[0]:i.value;o=$(l),o?q(t,e,n,o,s):r("html2canvas: Error loading background:",i)}}function Y(t,e){if(t.width===e.width&&t.height===e.height)return t;var n,r=se.createElement("canvas");return r.width=e.width,r.height=e.height,n=r.getContext("2d"),V(n,t,0,0,t.width,t.height,0,0,e.width,e.height),r}function J(t,e,n){var r=he(e,"opacity")*(n?n.opacity:1);return t.setVariable("globalAlpha",r),r}function K(t,e,n){var r=a(e?n.width:l(),e?n.height:d()),o={ctx:r,zIndex:R(he(t,"zIndex"),e?e.zIndex:null),opacity:J(r,t,e),cssPosition:he(t,"position"),borders:E(t),clip:e&&e.clip?c.Util.Extend({},e.clip):null};return s.useOverflow===!0&&/(hidden|scroll|auto)/.test(he(t,"overflow"))===!0&&/(BODY)/i.test(t.nodeName)===!1&&(o.clip=o.clip?T(o.clip,n):n),o.zIndex.children.push(o),o}function Z(t,e,n){var r={left:e.left+t[3].width,top:e.top+t[0].width,width:e.width-(t[1].width+t[3].width),height:e.height-(t[0].width+t[2].width)};return n&&(r=T(r,n)),r}function te(t,e,n){var o,i=c.Util.Bounds(t),a=ce.test(t.nodeName)?"#efefef":he(t,"backgroundColor"),s=K(t,e,i),l=s.borders,d=s.ctx,h=Z(l,i,s.clip),u=D(t,i,l);switch(N(d,u.clip),d.save(),d.clip(),h.height>0&&h.width>0&&(Q(d,i,a),X(t,h,d)),d.restore(),u.borders.forEach(function(t){P(d,t.args,t.color)}),n||H(t,s),t.nodeName){case"IMG":(o=$(t.getAttribute("src")))?M(d,t,o,i,l):r("html2canvas: Error loading <img>:"+t.getAttribute("src"));break;case"INPUT":/^(text|url|email|submit|button|reset)$/.test(t.type)&&(t.value||t.placeholder).length>0&&j(t,i,s);break;case"TEXTAREA":(t.value||t.placeholder||"").length>0&&j(t,i,s);break;case"SELECT":(t.options||t.placeholder||"").length>0&&j(t,i,s);break;case"LI":I(t,s,h);break;case"CANVAS":M(d,t,t,i,l)}return s}function ee(t){return"none"!==he(t,"display")&&"hidden"!==he(t,"visibility")&&!t.hasAttribute("data-html2canvas-ignore")}function ne(t,e,n){ee(t)&&(e=te(t,e,n)||e,ce.test(t.nodeName)||c.Util.Children(t).forEach(function(r){1===r.nodeType?ne(r,e,n):3===r.nodeType&&x(t,r,e)}))}function re(t,e){function n(t){var e,r,o,i,s,l=c.Util.Children(t),d=l.length;for(s=0;d>s;s+=1)if(i=l[s],3===i.nodeType)a+=i.nodeValue.replace(/</g,"&lt;").replace(/>/g,"&gt;");else if(1===i.nodeType&&!/^(script|meta|title)$/.test(i.nodeName.toLowerCase())){if(a+="<"+i.nodeName.toLowerCase(),i.hasAttributes())for(e=i.attributes,o=e.length,r=0;o>r;r+=1)a+=" "+e[r].name+'="'+e[r].value+'"';a+=">",n(i),a+="</"+i.nodeName.toLowerCase()+">"}}var r=new Image,o=l(),i=d(),a="";n(t),r.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' version='1.1' width='"+o+"' height='"+i+"'>","<foreignObject width='"+o+"' height='"+i+"'>","<html xmlns='http://www.w3.org/1999/xhtml' style='margin:0;'>",a.replace(/\#/g,"%23"),"</html>","</foreignObject>","</svg>"].join(""),r.onload=function(){e.svgRender=r}}function oe(){var t=te(ie,null);return le.svgRendering&&re(e.documentElement,t),Array.prototype.slice.call(ie.children,0).forEach(function(e){ne(e,t)}),t.backgroundColor=he(e.documentElement,"backgroundColor"),de.removeChild(pe),t}t.scroll(0,0);var ie=s.elements===n?e.body:s.elements[0],ae=0,se=ie.ownerDocument,le=c.Util.Support(s,se),ce=RegExp("("+s.ignoreElements+")"),de=se.body,he=c.Util.getCSS,ue="___html2canvas___pseudoelement",pe=se.createElement("style");pe.innerHTML="."+ue+'-before:before { content: "" !important; display: none !important; }'+"."+ue+'-after:after { content: "" !important; display: none !important; }',de.appendChild(pe),o=o||{};var ge=function(t){return function(e,n,r,o){var i=r*t,a=o*t,s=e+r,l=n+o;return{topLeft:U({x:e,y:l},{x:e,y:l-a},{x:s-i,y:n},{x:s,y:n}),topRight:U({x:e,y:n},{x:e+i,y:n},{x:s,y:l-a},{x:s,y:l}),bottomRight:U({x:s,y:n},{x:s,y:n+a},{x:e+i,y:l},{x:e,y:l}),bottomLeft:U({x:s,y:l},{x:s-i,y:l},{x:e,y:n+a},{x:e,y:n})}}}(4*((Math.sqrt(2)-1)/3));return oe()},c.Preload=function(o){function i(t){$.href=t,$.href=$.href;var e=$.protocol+$.host;return e===m}function a(){r("html2canvas: start: images: "+y.numLoaded+" / "+y.numTotal+" (failed: "+y.numFailed+")"),!y.firstRun&&y.numLoaded>=y.numTotal&&(r("Finished loading images: # "+y.numTotal+" (failed: "+y.numFailed+")"),"function"==typeof o.complete&&o.complete(y))}function s(e,r,i){var s,l,c=o.proxy;$.href=e,e=$.href,s="html2canvas_"+x++,i.callbackname=s,c+=c.indexOf("?")>-1?"&":"?",c+="url="+encodeURIComponent(e)+"&callback="+s,l=k.createElement("script"),t[s]=function(e){"error:"===e.substring(0,6)?(i.succeeded=!1,y.numLoaded++,y.numFailed++,a()):(f(r,i),r.src=e),t[s]=n;try{delete t[s]}catch(o){}l.parentNode.removeChild(l),l=null,delete i.script,delete i.callbackname},l.setAttribute("type","text/javascript"),l.setAttribute("src",c),i.script=l,t.document.body.appendChild(l)}function l(e,n){var r=t.getComputedStyle(e,n),o=r.content;"url"===o.substr(0,3)&&v.loadImage(c.Util.parseBackgroundImage(o)[0].args[0]),p(r.backgroundImage,e)}function d(t){l(t,":before"),l(t,":after")}function h(t,e){var r=c.Generate.Gradient(t,e);r!==n&&(y[t]={img:r,succeeded:!0},y.numTotal++,y.numLoaded++,a())}function u(t){return t&&t.method&&t.args&&t.args.length>0}function p(t,e){var r;c.Util.parseBackgroundImage(t).filter(u).forEach(function(t){"url"===t.method?v.loadImage(t.args[0]):t.method.match(/\-?gradient$/)&&(r===n&&(r=c.Util.Bounds(e)),h(t.value,r))})}function g(t){var e=!1;try{c.Util.Children(t).forEach(function(t){g(t)})}catch(o){}try{e=t.nodeType}catch(i){e=!1,r("html2canvas: failed to access some element's nodeType - Exception: "+i.message)}if(1===e||e===n){d(t);try{p(c.Util.getCSS(t,"backgroundImage"),t)}catch(o){r("html2canvas: failed to get background-image - Exception: "+o.message)}p(t)}}function f(e,r){e.onload=function(){r.timer!==n&&t.clearTimeout(r.timer),y.numLoaded++,r.succeeded=!0,e.onerror=e.onload=null,a()},e.onerror=function(){if("anonymous"===e.crossOrigin&&(t.clearTimeout(r.timer),o.proxy)){var i=e.src;return e=new Image,r.img=e,e.src=i,s(e.src,e,r),n}y.numLoaded++,y.numFailed++,r.succeeded=!1,e.onerror=e.onload=null,a()}}var m,v,b,w,y={numLoaded:0,numFailed:0,numTotal:0,cleanupDone:!1},x=0,C=o.elements[0]||e.body,k=C.ownerDocument,S=k.images,I=S.length,$=k.createElement("a"),T=function(t){return t.crossOrigin!==n}(new Image);for($.href=t.location.href,m=$.protocol+$.host,v={loadImage:function(e){var r,a;e&&y[e]===n&&(r=new Image,e.match(/data:image\/.*;base64,/i)?(r.src=e.replace(/url\(['"]{0,}|['"]{0,}\)$/gi,""),a=y[e]={img:r},y.numTotal++,f(r,a)):i(e)||o.allowTaint===!0?(a=y[e]={img:r},y.numTotal++,f(r,a),r.src=e):T&&!o.allowTaint&&o.useCORS?(r.crossOrigin="anonymous",a=y[e]={img:r},y.numTotal++,f(r,a),r.src=e,r.customComplete=function(){this.img.complete?this.img.onerror():this.timer=t.setTimeout(this.img.customComplete,100)}.bind(a),r.customComplete()):o.proxy&&(a=y[e]={img:r},y.numTotal++,s(e,r,a)))},cleanupDOM:function(i){var s,l;if(!y.cleanupDone){i&&"string"==typeof i?r("html2canvas: Cleanup because: "+i):r("html2canvas: Cleanup after timeout: "+o.timeout+" ms.");for(l in y)if(y.hasOwnProperty(l)&&(s=y[l],"object"==typeof s&&s.callbackname&&s.succeeded===n)){t[s.callbackname]=n;try{delete t[s.callbackname]}catch(c){}s.script&&s.script.parentNode&&(s.script.setAttribute("src","about:blank"),s.script.parentNode.removeChild(s.script)),y.numLoaded++,y.numFailed++,r("html2canvas: Cleaned up failed img: '"+l+"' Steps: "+y.numLoaded+" / "+y.numTotal)}t.stop!==n?t.stop():e.execCommand!==n&&e.execCommand("Stop",!1),e.close!==n&&e.close(),y.cleanupDone=!0,i&&"string"==typeof i||a()}},renderingDone:function(){w&&t.clearTimeout(w)}},o.timeout>0&&(w=t.setTimeout(v.cleanupDOM,o.timeout)),r("html2canvas: Preload starts: finding background-images"),y.firstRun=!0,g(C),r("html2canvas: Preload: Finding images"),b=0;I>b;b+=1)v.loadImage(S[b].getAttribute("src"));return y.firstRun=!1,r("html2canvas: Preload: Done."),y.numTotal===y.numLoaded&&a(),v},c.Renderer=function(t,r){function o(t){var e=[],n=function(t){var r=[],o=[];t.children.forEach(function(t){t.children&&t.children.length>0?(r.push(t),o.push(t.zindex)):e.push(t)}),o.sort(function(t,e){return t-e}),o.forEach(function(t){var e;r.some(function(n,r){return e=r,n.zindex===t}),n(r.splice(e,1)[0])})};return n(t.zIndex),e}function i(t){var e;if("string"==typeof r.renderer&&c.Renderer[t]!==n)e=c.Renderer[t](r);else{if("function"!=typeof t)throw Error("Unknown renderer");e=t(r)}if("function"!=typeof e)throw Error("Invalid renderer defined");return e}return i(r.renderer)(t,r,e,o(t),c)},c.Util.Support=function(t,e){function o(){var t=new Image,o=e.createElement("canvas"),i=o.getContext===n?!1:o.getContext("2d");if(i===!1)return!1;o.width=o.height=10,t.src=["data:image/svg+xml,","<svg xmlns='http://www.w3.org/2000/svg' width='10' height='10'>","<foreignObject width='10' height='10'>","<div xmlns='http://www.w3.org/1999/xhtml' style='width:10;height:10;'>","sup","</div>","</foreignObject>","</svg>"].join("");try{i.drawImage(t,0,0),o.toDataURL()}catch(a){return!1}return r("html2canvas: Parse: SVG powered rendering available"),!0}function i(){var t,n,r,o,i=!1;return e.createRange&&(t=e.createRange(),t.getBoundingClientRect&&(n=e.createElement("boundtest"),n.style.height="123px",n.style.display="block",e.body.appendChild(n),t.selectNode(n),r=t.getBoundingClientRect(),o=r.height,123===o&&(i=!0),e.body.removeChild(n))),i}return{rangeBounds:i(),svgRendering:t.svgRendering&&o()}},t.html2canvas=function(e,n){e=e.length?e:[e];var o,i,a={logging:!1,elements:e,background:"#fff",proxy:null,timeout:0,useCORS:!1,allowTaint:!1,svgRendering:!1,ignoreElements:"IFRAME|OBJECT|PARAM",useOverflow:!0,letterRendering:!1,chinese:!1,width:null,height:null,taintTest:!0,renderer:"Canvas"};return a=c.Util.Extend(n,a),c.logging=a.logging,a.complete=function(t){("function"!=typeof a.onpreloaded||a.onpreloaded(t)!==!1)&&(o=c.Parse(t,a),("function"!=typeof a.onparsed||a.onparsed(o)!==!1)&&(i=c.Renderer(o,a),"function"==typeof a.onrendered&&a.onrendered(i)))},t.setTimeout(function(){c.Preload(a)},0),{render:function(t,e){return c.Renderer(t,c.Util.Extend(e,a))},parse:function(t,e){return c.Parse(t,c.Util.Extend(e,a))},preload:function(t){return c.Preload(c.Util.Extend(t,a))},log:r}},t.html2canvas.log=r,t.html2canvas.Renderer={Canvas:n},c.Renderer.Canvas=function(t){function o(t,e){t.beginPath(),e.forEach(function(e){t[e.name].apply(t,e.arguments)}),t.closePath()}function i(t){if(-1===c.indexOf(t.arguments[0].src)){h.drawImage(t.arguments[0],0,0);try{h.getImageData(0,0,1,1)}catch(e){return d=l.createElement("canvas"),h=d.getContext("2d"),!1}c.push(t.arguments[0].src)}return!0}function a(t){return"transparent"===t||"rgba(0, 0, 0, 0)"===t}function s(e,n){switch(n.type){case"variable":e[n.name]=n.arguments;break;case"function":if("createPattern"===n.name){if(n.arguments[0].width>0&&n.arguments[0].height>0)try{e.fillStyle=e.createPattern(n.arguments[0],"repeat")}catch(a){r("html2canvas: Renderer: Error creating pattern",a.message)}}else"drawShape"===n.name?o(e,n.arguments):"drawImage"===n.name?n.arguments[8]>0&&n.arguments[7]>0&&(!t.taintTest||t.taintTest&&i(n))&&e.drawImage.apply(e,n.arguments):e[n.name].apply(e,n.arguments)}}t=t||{};var l=e,c=[],d=e.createElement("canvas"),h=d.getContext("2d"),u=t.canvas||l.createElement("canvas");return function(t,e,o,i,l){var c,d,h,p,g,f,m=u.getContext("2d");if(u.width=u.style.width=e.width||t.ctx.width,u.height=u.style.height=e.height||t.ctx.height,f=m.fillStyle,m.fillStyle=a(t.backgroundColor)&&e.background!==n?e.background:t.backgroundColor,m.fillRect(0,0,u.width,u.height),m.fillStyle=f,e.svgRendering&&t.svgRender!==n)m.drawImage(t.svgRender,0,0);else for(d=0,h=i.length;h>d;d+=1)c=i.splice(0,1)[0],c.canvasPosition=c.canvasPosition||{},m.textBaseline="bottom",c.clip&&(m.save(),m.beginPath(),m.rect(c.clip.left,c.clip.top,c.clip.width,c.clip.height),m.clip()),c.ctx.storage&&c.ctx.storage.forEach(s.bind(null,m)),c.clip&&m.restore();return r("html2canvas: Renderer: Canvas renderer done - returning canvas obj"),h=e.elements.length,1===h&&"object"==typeof e.elements[0]&&"BODY"!==e.elements[0].nodeName?(g=l.Util.Bounds(e.elements[0]),p=o.createElement("canvas"),p.width=g.width,p.height=g.height,m=p.getContext("2d"),m.drawImage(u,g.left,g.top,g.width,g.height,0,0,g.width,g.height),u=null,p):u}}}(window,document);