function report_warmup_dyn(e,t){$.getScript("assets/js/dependencies.js"),document.createStyleSheet?(document.createStyleSheet("assets/css/bootstrap.min.css"),document.createStyleSheet("assets/css/jquery.ui.css")):($("head").append($('<link rel="stylesheet" type="text/css" />').attr("href","assets/css/bootstrap.min.css")),$("head").append($('<link rel="stylesheet" type="text/css" />').attr("href","assets/css/jquery.ui.css"))),report.canvas=isCanvasSupported(),drawDialog(),goStep1(),report.user=e,report.productInfo=t}function report_warmup(){$("#feedback").on("click",function(){drawDialog(),goStep1()})}function saveReport(){$("#reportDialog").dialog({width:500}),$("#step3").hide("blind",{direction:"vertical"},200),$("#step4").show("blind",{direction:"vertical"},200),finishButtons(),console.log(report)}function drawDialog(){var e='<div id="reportDialog" title="Give us your feedback :)"></div>';step1=' <div id="step1">        <form>          <div class="row-fluid">          Report Back lets you send suggestions about the product.					 We welcome problem reports, feature ideas and general comments.<br/><br/>					 Legal notifications sent through Report Back will not be processed and they\'r something I don\'t care about in here.(Legal mambo-jambo)<br/><br/>					 Start by writing a brief description:          <textarea id="usrDescription" rows="5" class="span12"></textarea>						Next we\'ll let you identify areas of the page related to your description.          </div>        </form>      </div>',step2='<div id="step2" style="display:none;">	<p>Click and drag on the page to help us better understand your feedback.			 You can move this dialog if it\'s in the way.</p>			<div>				<div class="row-fluid">					<div class="span12"> <button id="highlight" class="btn btn-primary" type="button"><i class="icon-eye-open"></i> Highlight&nbsp;</button>					 Highlight areas relevant to your feedback.</div>				</div><br/>				<div class="row-fluid">					<div class="span12"> <button id="block" class="btn" type="button"><i class="icon-eye-close"></i> Black out</button>					 Black out any personal information.</div>				</div><br/>				<div class="row-fluid">					<div class="span12"> <button id="clear" class="btn" type="button"><i class="icon-remove"></i> Clear&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</button>					 Remove all boxes.</div>				</div>				</div>			</div>',step3='<div id="step3" style="display:none;">	<div class="row-fluid">	<div class="span6" style="max-height: 350px;overflow-y: scroll;}">		<form>	    <div class="row-fluid">	    <label><b>Description</b></label>			<div id="usertext" style="margin-left:20px;"></div>	    <label><b>Aditional Info</b></label>	    <div class="accordion" id="envInfo" style="margin-left:20px;">	      <div class="accordion-group">	          <div class="accordion-heading">	              <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseOne">	                  User info</a>	          </div>	          <div id="collapseOne" class="accordion-body collapse">	              <div class="accordion-inner userInfo"></div>	          </div>	      </div>	          <div class="accordion-group">	              <div class="accordion-heading">	                  <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseTwo">	                      Page info </a>	              </div>	              <div id="collapseTwo" class="accordion-body collapse">	                  <div class="accordion-inner pageInfo"></div>	              </div>	          </div>	          <div class="accordion-group">	          <div class="accordion-heading">	              <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseThree">	                 Browser info </a>	          </div>	          <div id="collapseThree" class="accordion-body collapse">	              <div class="accordion-inner browserInfo"></div>	          </div>	      </div>	    </div>	    </div>	   </form>		</div>		<div class="span6">			<div id="screenPreview">					<b>Screenshot</b>					<div id="thumbProgress" class="progress progress-striped active">						<div class="bar" style="width: 100%;"></div>					</div>			<div id="screenshootImg">					</div>			</div>		</div>		</div>	</div>',step3noCanvas='<div id="step3" style="display:none;">	<div class="row-fluid">	<div class="span12" style="max-height: 350px;overflow-y: scroll;}">		<form>	    <div class="row-fluid">	    <label><b>Description</b></label>			<div id="usertext" style="margin-left:20px;"></div>	    <label><b>Aditional Info</b></label>	    <div class="accordion" id="envInfo" style="margin-left:20px;">	      <div class="accordion-group">	          <div class="accordion-heading">	              <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseOne">	                  User info</a>	          </div>	          <div id="collapseOne" class="accordion-body collapse">	              <div class="accordion-inner userInfo"></div>	          </div>	      </div>	          <div class="accordion-group">	              <div class="accordion-heading">	                  <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseTwo">	                      Page info </a>	              </div>	              <div id="collapseTwo" class="accordion-body collapse">	                  <div class="accordion-inner pageInfo"></div>	              </div>	          </div>	          <div class="accordion-group">	          <div class="accordion-heading">	              <a class="accordion-toggle" data-toggle="collapse" data-parent="#envInfo" href="#collapseThree">	                 Browser info </a>	          </div>	          <div id="collapseThree" class="accordion-body collapse">	              <div class="accordion-inner browserInfo"></div>	          </div>	      </div>	    </div>	    </div>	   </form>		</div>		</div>	</div>',step4='<div id="step4" style="display:none;">				<h3>All done</h3>  Now it\'s up to you to do something with the gathered info.				<br/>Check console to view the log of the report object 		</div>',$("body").append(e),report.canvas?$("#reportDialog").append(step1+step2+step3+step4):$("#reportDialog").append(step1+step3noCanvas+step4)}function cleanup(){hideCanvas(),$("#feedback").show(),$("#step1").show(),$("#step2").hide(),$("#step3").hide(),$("#step4").hide(),$("#feedback").unbind("click").on("click",function(){goStep1()}),$(".pageInfo").empty(),$(".userInfo").empty(),$(".browserInfo").empty(),cleanThumbElement()}function goStep1(){$("#feedback").hide(),$("#reportDialog").dialog({width:500,modal:!1,resizable:!1,zIndex:1050,close:function(){cleanup()}}),$(".ui-dialog ").css("position","fixed"),$("#reportDialog").dialog("option","position","center"),$("#step2").is(":visible")?$("#step2").hide("blind",{direction:"vertical"},500):$("#step3").is(":visible")&&$("#step3").hide("blind",{direction:"vertical"},500),$("#step1").show("blind",{direction:"vertical"},500),setStep1Buttons(),$(".ui-dialog-titlebar").css("cursor","auto")}function goStep2(){var e=$("#reportDialog");e.dialog({width:500}),e.dialog("widget").animate({left:$(window).width()-550,top:$(window).height()-350},1e3),$("#step2").show("blind",{direction:"vertical"},500),$("#step1").is(":visible")?$("#step1").hide("blind",{direction:"vertical"},500):$("#step3").is(":visible")&&$("#step3").hide("blind",{direction:"vertical"},500),setStep2Buttons(),drawInCanvas()}function goStep3(){$("#reportDialog").dialog("widget").animate({left:$(window).width()/2-450,top:$(window).height()/2-260},1e3),$("#reportDialog").dialog({width:900}),$("#step1").is(":visible")&&$("#step1").hide("blind",{direction:"vertical"},500),$("#step2").hide("blind",{direction:"vertical"},500),$("#step3").show("blind",{direction:"vertical"},500),setStep3Buttons(),fillInInfo(),report.canvas&&setTimeout(function(){takeScreenShot()},1e3)}function setStep1Buttons(){$("#reportDialog").dialog({buttons:[{text:"Next",click:function(){report.description=$("#usrDescription").val(),report.canvas?goStep2():goStep3()}}]}),$(".ui-dialog-buttonset :button").addClass("btn")}function setStep2Buttons(){$("#reportDialog").dialog({buttons:[{text:"Back",click:function(){goStep1(),$("#reportDialog").dialog("widget").animate({left:$(window).width()/2-250,top:$(window).height()/2-200},1e3)}},{text:"Next",click:function(){goStep3()}}]}),$(".ui-dialog-buttonset :button").addClass("btn")}function setStep3Buttons(){$("#reportDialog").dialog({buttons:[{text:"Back",click:function(){report.canvas?(goStep2(),cleanThumbElement()):goStep1()}},{text:"Submit",click:function(){report.description=$("#updatedDescription").val(),saveReport()}}]}),$(".ui-dialog-buttonset :button").addClass("btn")}function finishButtons(){$("#reportDialog").dialog({buttons:[{text:"ok",click:function(){$("#reportDialog").dialog("close"),cleanup()}}]}),$(".ui-dialog-buttonset :button").addClass("btn")}function isCanvasSupported(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}function drawViewportBox(){context.strokeStyle="red";var e=$(window);context.strokeRect(e.scrollLeft(),e.scrollTop(),e.width(),e.height())}function makeThumbnail(){var e=$(window),t=new Image;t.src=report.screenshot,$("body").append('<canvas id="thumbCanvas"></canvas>');var o=$("#thumbCanvas");o[0].width=e.width(),o[0].height=e.height(),$("body").append('<canvas id="thumbCanvasBlank" style="display:none"></canvas>');var i=$("#thumbCanvasBlank");i[0].width=e.width(),i[0].height=e.height(),startCrop(t,e,o,i)}function startCrop(e,t,o,i){var n=o[0].getContext("2d");n.drawImage(e,t.scrollLeft(),t.scrollTop(),t.width(),t.height(),0,0,t.width(),t.height()),o[0].toDataURL()==i[0].toDataURL()?setTimeout(function(){startCrop(e,t,o,i)},500):finishCrop(e,t,o,i)}function finishCrop(e,t,o,i){if(report.thumb=o[0].toDataURL(),o.hide(),$("#thumbProgress").hide(),o[0].toDataURL()!=i[0].toDataURL())$("#screenshootImg").append("<img class='screenShotCanvas' src='"+report.thumb+"' alt='Page Screenshot' width='400' >");else{var n="There was a problem creating the screenshot :(<br/> Don't worry, submit your feedback anyway";$("#screenshootImg").append(n)}}function takeScreenShot(){drawViewportBox();var e=$(window),t=e.scrollTop(),o=e.scrollLeft();$(".ui-dialog").attr("data-html2canvas-ignore","true"),html2canvas($("body"),{onrendered:function(i){var n=i.toDataURL();e.scrollTop(t),e.scrollLeft(o),report.screenshot=n,hideCanvas(),makeThumbnail()}})}function hideCanvas(){$("#canvas").hide(),$("#myCanvas").hide()}function cleanThumbElement(){$("#screenshootImg").empty(),$("#thumbProgress").show()}function fillInInfo(){writeUserComment(),writeProductInfo(),writeUserInfo(),writePageInfo(),writeBrowserInfo()}function stripTags(e){return e.replace(/<\/?[^>]+>/gi,"")}function dumpVars(e,t,o){$div=$(t),jQuery.each(e,function(e,t){"function"!=typeof t&&-1==jQuery.inArray(e,o)&&""!==t&&$div.append(e+" : "+t+"<br/>")})}function showPlugins(){for(var e=navigator.plugins.length,t="",o=0;e>o;o++)t+='<a rel="tooltip" href="#" data-original-title="'+stripTags(navigator.plugins[o].description)+'" data-triger="hover" data-placement="right">'+navigator.plugins[o].name+"</a>",t+=" , ",t+=navigator.plugins[o].filename,navigator.plugins[o].version&&(t+=" | ",t+=navigator.plugins[o].version),t+="<br>";return t}function get_cookies_array(){var e={};if(document.cookie&&""!==document.cookie)for(var t=document.cookie.split(";"),o=0;t.length>o;o++){var i=t[o].split("=");i[0]=i[0].replace(/^ /,""),e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}function writeBrowserInfo(){var e=$(".browserInfo");e.append("<h4>Browser version:</h4>"),dumpVars(jQuery.browser,".browserInfo"),report.browserInfo=jQuery.browser,e.append("<h4>Operating System: </h4>"),dumpVars(navigator,".browserInfo",["plugins","mimeTypes"]),report.navigator=navigator,e.append("<h4>Installed Plugins: </h4>"+showPlugins())}function writePageInfo(){var e=$(".pageInfo");e.append("<h4>Page Url:</h4>"),dumpVars(window.location,".pageInfo",["ancestorOrigins"]),report.location=window.location;var t=$.base64.encode($("html").clone().html());e.append("<h4>Encoded Page Structure:</h4>").append("<div class='row-fluid'><textarea rows='4' class='span12'>"+t+"</textarea></div>"),report.encodedHtml=t}function writeUserInfo(){var e=$(".userInfo");null!==report.user&&(e.append("<h4>User Info:</h4>"),dumpVars(report.user,".userInfo"));var t=get_cookies_array();$.isEmptyObject(t)||(e.append("<h4>Cookies:</h4>"),dumpVars(t,".userInfo"),report.cookies=t)}function writeUserComment(){var e="<textarea rows='4' class='span12' id='updatedDescription'>"+report.description+"</textarea>";$("#usertext").html(e)}function writeProductInfo(){var e='<label><b>Product Info</b></label>			<div id="prodInfo" style="margin-left:20px;"></div>';null!==report.productInfo&&($("#usertext").after(e),dumpVars(report.productInfo,"#prodInfo"))}function drawInCanvas(){function e(){var e=i(),t=n();s.width(e),s.height(t),r.attr({width:e,height:t}),context.fillStyle=d,context.fillRect(0,0,r.width(),r.height()),o()}function t(){s.width(0),s.height(0),r.attr({width:0,height:0})}function o(){context.clearRect(0,0,r.width(),r.height()),context.fillStyle=d,context.fillRect(0,0,r.width(),r.height())}function i(){return document.documentElement.offsetWidth}function n(){var e=document;return Math.max(Math.max(e.body.scrollHeight,e.documentElement.scrollHeight),Math.max(e.body.offsetHeight,e.documentElement.offsetHeight),Math.max(e.body.clientHeight,e.documentElement.clientHeight))}var a='<canvas id="myCanvas"></canvas><div id="canvas"></div>';$("body").append(a),$("#canvas, #myCanvas").css({position:"absolute",left:"0px",top:"0px",display:"block",cursor:"default","z-index":"1040"});var s=$("#canvas"),r=$("#myCanvas");context=r[0].getContext("2d");var d="rgba(0, 0, 0, 0.295)",c="rgba(0, 0, 0, 1)",l="rgba(0, 0, 0, 0)";e();var p="highlight";$(window).resize(function(){t(),e()}),$.extend($.ui.boxer,{defaults:$.extend({},$.ui.mouse.defaults,{appendTo:"body",distance:0})}),$("#highlight").on("click",function(){$("#reportDialog button").removeClass("btn-primary"),$(this).addClass("btn-primary"),p="highlight"}),$("#block").on("click",function(){$("#reportDialog button").removeClass("btn-primary"),$(this).addClass("btn-primary"),p="block"}),$("#clear").on("click",function(){o()}),$.widget("ui.boxer",$.ui.mouse,{options:{appendTo:"body",distance:0},_init:function(){this.element.addClass("ui-boxer"),this.dragged=!1,this._mouseInit(),this.helper=$(document.createElement("div")).css({border:"1px dotted red"}).addClass("ui-boxer-helper")},_mouseStart:function(e){if(this.opos=[e.pageX,e.pageY],!this.options.disabled){var t=this.options;this._trigger("start",e),$(t.appendTo).append(this.helper),this.helper.css({position:"absolute",left:e.clientX,top:e.clientY,width:0,height:0,"z-index":1040}),"highlight"==p?this.helper.css({background:l}):this.helper.css({background:d})}},_mouseDrag:function(e){if(this.dragged=!0,!this.options.disabled){this.options;var t,o=this.opos[0],i=this.opos[1],n=e.pageX,a=e.pageY;return o>n&&(t=n,n=o,o=t),i>a&&(t=a,a=i,i=t),this.helper.css({left:o,top:i,width:n-o,height:a-i}),this._trigger("drag",e),!1}},_mouseStop:function(){this.dragged=!1,this.options,this.helper.clone();var e=this.helper.offset().top,t=this.helper.offset().left,o=this.helper.width(),i=this.helper.height();return"highlight"==p?context.clearRect(t,e,o,i):(context.fillStyle=c,context.fillRect(t,e,o,i)),this.helper.remove(),!1}}),$.extend($.ui.boxer.prototype,{options:$.extend({},$.ui.mouse.prototype.options,{appendTo:"#canvas",distance:0})}),$(window).boxer({stop:function(e,t){t.box.offset(),console.log(t.box)}})}var report=[];(function(){var e,t;jQuery.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||0>e.indexOf("compatible")&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},e=jQuery.uaMatch(navigator.userAgent),t={},e.browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),jQuery.browser=t,jQuery.sub=function(){function e(t,o){return new e.fn.init(t,o)}jQuery.extend(!0,e,this),e.superclass=this,e.fn=e.prototype=this(),e.fn.constructor=e,e.sub=this.sub,e.fn.init=function(o,i){return i&&i instanceof jQuery&&!(i instanceof e)&&(i=e(i)),jQuery.fn.init.call(this,o,i,t)},e.fn.init.prototype=e.fn;var t=e(document);return e}})();